webpackJsonp([1],{"4WSK":function(e,t){},KwFe:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={};s.d(o,"login",function(){return Z}),s.d(o,"logout",function(){return X}),s.d(o,"getsite",function(){return j}),s.d(o,"delsite",function(){return J}),s.d(o,"addsite",function(){return ee}),s.d(o,"upsite",function(){return te}),s.d(o,"getftp",function(){return se}),s.d(o,"addftp",function(){return oe}),s.d(o,"delftp",function(){return ae}),s.d(o,"upftp",function(){return ne}),s.d(o,"getmysql",function(){return ie}),s.d(o,"addmysql",function(){return re}),s.d(o,"delmysql",function(){return le}),s.d(o,"upmysql",function(){return fe}),s.d(o,"gethome",function(){return ce}),s.d(o,"getsoft",function(){return me}),s.d(o,"upsoft",function(){return ue}),s.d(o,"addssl",function(){return pe}),s.d(o,"changepwd",function(){return de}),s.d(o,"getfile",function(){return _e}),s.d(o,"delfile",function(){return he}),s.d(o,"upfile",function(){return ge});var a=s("xd7I"),n=s("bzuk"),i=s.n(n),r=(s("4WSK"),{name:"App",data:function(){return{navList:[{id:1,title:"首页",name:"Home"},{id:2,title:"站点",name:"Site"},{id:3,title:"FTP",name:"Ftp"},{id:4,title:"MYSQL",name:"Mysql"},{id:5,title:"软件",name:"Soft"}],activeIndex:""}},methods:{handleSelect:function(e,t){},logout:function(){console.log("logout"),localStorage.clear(),this.$store.dispatch("accountLogout")}},computed:{userInfo:function(){return this.$store.state.userInfo}}}),l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[e.userInfo.token?s("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},[e._l(e.navList,function(t){return s("el-menu-item",{key:t.id,attrs:{index:"item.id"}},[s("router-link",{attrs:{to:{name:t.name}}},[e._v(e._s(t.title))])],1)}),e._v(" "),s("el-menu-item",[s("a",{attrs:{href:""},on:{click:e.logout}},[e._v("退出")])])],2):e._e(),e._v(" "),s("router-view")],1)},staticRenderFns:[]};var f=s("C7Lr")(r,l,!1,function(e){s("rHZV")},null,null).exports,c=s("pZCi"),m={name:"Home",data:function(){return{timer:null,loadavg:{},sysinfo:{},diskinfo:{},netinfo:{net_in:{eth0:"loading"},net_out:{eth0:"loading"}},dialogFormVisible:!1,repasswdform:{oldpasswd:"",newpasswd:""},formLabelWidth:"120px"}},methods:{getloadavg:function(e){var t=this;this.$http.gethome(e).then(function(s){0===s.errcode&&("sysinfo"==e?t.sysinfo=s.data:"loadavg"==e?t.loadavg=s.data:"diskinfo"==e?t.diskinfo=s.data:"netinfo"==e&&(t.netinfo=s.data))}).catch(function(e){console.log(e)})},repasswd:function(){this.dialogFormVisible=!0,this.repasswdform={oldpasswd:"",newpasswd:""}},repasswd2:function(){var e=this;this.dialogFormVisible=!1,this.$http.changepwd(this.repasswdform).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&e.$alert("密码修改成功,不过需要重新登录","重新登录",{confirmButtonText:"确定",callback:function(t){e.$store.dispatch("accountLogout").then(function(){localStorage.clear(),location.reload()})}})}).catch(function(e){e.response})}},computed:{userInfo:function(){return this.$store.state.userInfo}},created:function(){var e=this;this.getloadavg("sysinfo"),this.getloadavg("loadavg"),this.getloadavg("diskinfo"),this.timer=setInterval(function(){e.getloadavg("loadavg"),e.getloadavg("netinfo")},5e3)},destroyed:function(){clearInterval(this.timer)},components:{}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"},[s("span",{staticClass:"el-icon-user-solid",on:{click:e.repasswd}},[e._v(e._s(e.userInfo.username))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("负 载 "+e._s(e.loadavg.one)+" "+e._s(e.loadavg.five)+" "+e._s(e.loadavg.fifteen))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("eth0发送流量 "+e._s(e.netinfo.net_out.eth0)+" eth0接收流量 "+e._s(e.netinfo.net_in.eth0))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("CPU "+e._s(e.sysinfo.cputype)+" 核心 "+e._s(e.sysinfo.cpunum))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("内存总大小 "+e._s(e.sysinfo.memtotal)+" 可用 "+e._s(e.sysinfo.memfree)+" 使用率 "+e._s(e.sysinfo.mempercent))]),e._v(" "),s("el-divider"),e._v(" "),s("span",{staticClass:"el-icon-setting"},[e._v("根分区 总大小 "+e._s(e.diskinfo.datotal)+" 可用 "+e._s(e.diskinfo.dafree)+" 使用率 "+e._s(e.diskinfo.dapercent))]),e._v(" "),s("el-dialog",{attrs:{title:"修改密码",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.repasswdform}},[s("el-form-item",{attrs:{label:"原密码","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.repasswdform.oldpasswd,callback:function(t){e.$set(e.repasswdform,"oldpasswd",t)},expression:"repasswdform.oldpasswd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"新密码","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.repasswdform.newpasswd,callback:function(t){e.$set(e.repasswdform,"newpasswd",t)},expression:"repasswdform.newpasswd"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("返 回")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.repasswd2}},[e._v("修 改")])],1)],1)],1)},staticRenderFns:[]};var p=s("C7Lr")(m,u,!1,function(e){s("u8Cu")},null,null).exports,d={name:"Site",data:function(){return{is_sitelist:!0,is_create:!0,is_update:!1,sitelistData:[],pages:1,num:5,page:1,total:1,search:"",nid:"",form:{site_name:"",bind_domain:"",root_path:"",ftpinfo:{is_create:!1,ftp_user:""},mysqlinfo:{is_create:!1,mysql_user:"",mysql_name:"",accept:"localhost"},site_info:{is_ssl:!1,is_log:!1,log_path:"",php_ver:"php5.6",domain_301:"",sslcrt:"",sslkey:"",extra_kwargs:{rewrite:"",set_301:!1,set_404:!1,deny_ua:!0,deny_referer:!0,safe:!0,cache:!0}}},form2:{site_info:{sslcrt:"",sslkey:"",extra_kwargs:{}}},ftpmsg:"",mysqlmsg:""}},methods:{goFile:function(e){this.$router.push({name:"File",params:{d:e}})},handleCurrentChange:function(e){this.page=e,this.onGetsite()},onGetsite:function(){var e=this,t={nid:this.nid,page:this.page};this.$http.getsite(t).then(function(t){0===t.errcode&&(e.sitelistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_sitelist=!1))}).catch(function(e){})},handleEdit:function(e){this.nid=e,this.onGetsite()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delsite(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){e.data;t.onGetsite()}}).catch(function(e){})},onUpsite:function(){var e=this;if(this.form2.site_info.is_ssl){var t=new FormData;t.append("crt",this.form2.site_info.sslcrt),t.append("key",this.form2.site_info.sslkey),t.append("site_name",this.form2.site_name),t.append("bind_domain",this.form2.bind_domain),this.$http.addssl(t).then(function(t){0===t.errcode&&e.onUpsite2()})}else this.onUpsite2()},onUpsite2:function(){var e=this;delete this.form2.status_text,delete this.form2.created,this.$http.upsite(this.form2).then(function(t){if(0===t.errcode){t.data;e.$message({message:"更新站点成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_sitelist=!0,e.nid="",e.onGetsite()}}).catch(function(e){})},onAddsite:function(){var e=this;if(this.errmsg="",this.form.ftpinfo.is_create){var t={ftp_user:this.form.ftpinfo.ftp_user,ftp_passwd:this.form.ftpinfo.ftp_passwd,ftp_path:this.form.root_path};this.$http.addftp(t).then(function(t){0===t.errcode&&(e.ftpmsg="FTP创建成功,")})}if(this.form.mysqlinfo.is_create){var s={mysql_user:this.form.mysqlinfo.mysql_user,mysql_name:this.form.mysqlinfo.mysql_name,mysql_passwd:this.form.mysqlinfo.mysql_passwd,accept:this.form.mysqlinfo.accept};this.$http.addmysql(s).then(function(t){0===t.errcode&&(e.mysqlmsg="MYSQL创建成功,")})}if(this.form.site_info.is_ssl){var o=new FormData;o.append("crt",this.form.site_info.sslcrt),o.append("key",this.form.site_info.sslkey),o.append("site_name",this.form.site_name),o.append("bind_domain",this.form.bind_domain),this.$http.addssl(o).then(function(t){0===t.errcode&&e.onAddsite2()})}else this.onAddsite2()},onAddsite2:function(){var e=this;this.$http.addsite(this.form).then(function(t){0===t.errcode&&(e.onGetsite(),e.$message({message:""+e.ftpmsg+e.mysqlmsg+"站点创建成功",type:"success"}))}).catch(function(e){})},onGetinfo:function(){this.form.root_path="/home/wwwroot/"+this.form.site_name,this.form.bind_domain=this.form.site_name+".com,www."+this.form.site_name+".com",this.form.ftpinfo.ftp_user=this.form.site_name,this.form.mysqlinfo.mysql_user=this.form.site_name,this.form.mysqlinfo.mysql_name=this.form.site_name},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_sitelist=!0,this.onGetsite(this.nid)}},created:function(){this.onGetsite()}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"site"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_sitelist,expression:"is_sitelist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.sitelistData}},[s("el-table-column",{attrs:{label:"站点名",prop:"site_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"网站根目录",prop:"root_path"}}),e._v(" "),s("el-table-column",{attrs:{label:"绑定域名",prop:"bind_domain"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-files"},on:{click:function(s){return e.goFile(t.row.root_path)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_sitelist,expression:"is_sitelist"}],staticStyle:{"margin-top":"20px","text-align":"center"}},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.num,"page-count":e.pages},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"站点名"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},nativeOn:{keyup:function(t){return e.onGetinfo(t)}},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"绑定域名"}},[s("el-input",{attrs:{placeholder:"多个域名以英文逗号,分隔,中文域名请绑定转码"},model:{value:e.form.bind_domain,callback:function(t){e.$set(e.form,"bind_domain",t)},expression:"form.bind_domain"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站根目录"}},[s("el-input",{attrs:{placeholder:"默认/home/wwwroot/站点名"},model:{value:e.form.root_path,callback:function(t){e.$set(e.form,"root_path",t)},expression:"form.root_path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"PHP版本"}},[s("el-select",{attrs:{placeholder:"请选择PHP版本"},model:{value:e.form.site_info.php_ver,callback:function(t){e.$set(e.form.site_info,"php_ver",t)},expression:"form.site_info.php_ver"}},[s("el-option",{attrs:{label:"php5.6",value:"php5.6"}}),e._v(" "),s("el-option",{attrs:{label:"php7.0",value:"php7.0"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"创建FTP"}},[s("el-switch",{model:{value:e.form.ftpinfo.is_create,callback:function(t){e.$set(e.form.ftpinfo,"is_create",t)},expression:"form.ftpinfo.is_create"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.ftpinfo.is_create,expression:"form.ftpinfo.is_create"}],attrs:{label:"FTP用户名"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.ftpinfo.ftp_user,callback:function(t){e.$set(e.form.ftpinfo,"ftp_user",t)},expression:"form.ftpinfo.ftp_user"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.ftpinfo.is_create,expression:"form.ftpinfo.is_create"}],attrs:{label:"FTP密码"}},[s("el-input",{attrs:{placeholder:"请输入密码,不填是随机密码","show-password":""},model:{value:e.form.ftpinfo.ftp_passwd,callback:function(t){e.$set(e.form.ftpinfo,"ftp_passwd",t)},expression:"form.ftpinfo.ftp_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"创建MYSQL"}},[s("el-switch",{model:{value:e.form.mysqlinfo.is_create,callback:function(t){e.$set(e.form.mysqlinfo,"is_create",t)},expression:"form.mysqlinfo.is_create"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.mysqlinfo.is_create,expression:"form.mysqlinfo.is_create"}],attrs:{label:"Mysql用户名"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysqlinfo.mysql_user,callback:function(t){e.$set(e.form.mysqlinfo,"mysql_user",t)},expression:"form.mysqlinfo.mysql_user"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.mysqlinfo.is_create,expression:"form.mysqlinfo.is_create"}],attrs:{label:"Mysql数据库"}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysqlinfo.mysql_name,callback:function(t){e.$set(e.form.mysqlinfo,"mysql_name",t)},expression:"form.mysqlinfo.mysql_name"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.mysqlinfo.is_create,expression:"form.mysqlinfo.is_create"}],attrs:{label:"Mysql密码"}},[s("el-input",{attrs:{placeholder:"请输入密码,不填是随机密码","show-password":""},model:{value:e.form.mysqlinfo.mysql_passwd,callback:function(t){e.$set(e.form.mysqlinfo,"mysql_passwd",t)},expression:"form.mysqlinfo.mysql_passwd"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.mysqlinfo.is_create,expression:"form.mysqlinfo.is_create"}],attrs:{label:"连接方式"}},[s("el-input",{attrs:{placeholder:"%/localhost/ip地址"},model:{value:e.form.mysqlinfo.accept,callback:function(t){e.$set(e.form.mysqlinfo,"accept",t)},expression:"form.mysqlinfo.accept"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启SSL"}},[s("el-switch",{model:{value:e.form.site_info.is_ssl,callback:function(t){e.$set(e.form.site_info,"is_ssl",t)},expression:"form.site_info.is_ssl"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.site_info.is_ssl,expression:"form.site_info.is_ssl"}],attrs:{label:"crt的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----"},model:{value:e.form.site_info.sslcrt,callback:function(t){e.$set(e.form.site_info,"sslcrt",t)},expression:"form.site_info.sslcrt"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.site_info.is_ssl,expression:"form.site_info.is_ssl"}],attrs:{label:"key的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN RSA PRIVATE KEY----- ... -----END RSA PRIVATE KEY-----"},model:{value:e.form.site_info.sslkey,callback:function(t){e.$set(e.form.site_info,"sslkey",t)},expression:"form.site_info.sslkey"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启301"}},[s("el-switch",{model:{value:e.form.site_info.extra_kwargs.set_301,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"set_301",t)},expression:"form.site_info.extra_kwargs.set_301"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.site_info.extra_kwargs.set_301,expression:"form.site_info.extra_kwargs.set_301"}],attrs:{label:"跳转的域名"}},[s("el-input",{attrs:{placeholder:"请输入301目标地址,比如www.ropon.top,中文域名请绑定转码"},model:{value:e.form.site_info.domain_301,callback:function(t){e.$set(e.form.site_info,"domain_301",t)},expression:"form.site_info.domain_301"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启日志"}},[s("el-switch",{model:{value:e.form.site_info.is_log,callback:function(t){e.$set(e.form.site_info,"is_log",t)},expression:"form.site_info.is_log"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"额外设置"}},[e._v("\n      开启404错误页\n      "),s("el-switch",{model:{value:e.form.site_info.extra_kwargs.set_404,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"set_404",t)},expression:"form.site_info.extra_kwargs.set_404"}}),e._v("屏蔽非常见UA\n      "),s("el-switch",{model:{value:e.form.site_info.extra_kwargs.deny_ua,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"deny_ua",t)},expression:"form.site_info.extra_kwargs.deny_ua"}}),e._v("启用防盗链\n      "),s("el-switch",{model:{value:e.form.site_info.extra_kwargs.deny_referer,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"deny_referer",t)},expression:"form.site_info.extra_kwargs.deny_referer"}}),e._v("安全加固\n      "),s("el-switch",{model:{value:e.form.site_info.extra_kwargs.safe,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"safe",t)},expression:"form.site_info.extra_kwargs.safe"}}),e._v("开启缓存\n      "),s("el-switch",{model:{value:e.form.site_info.extra_kwargs.cache,callback:function(t){e.$set(e.form.site_info.extra_kwargs,"cache",t)},expression:"form.site_info.extra_kwargs.cache"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站备注"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddsite}},[e._v("创建站点")]),e._v(" "),s("el-button",[e._v("取消")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"站点名"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form2.site_name,callback:function(t){e.$set(e.form2,"site_name",t)},expression:"form2.site_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"绑定域名"}},[s("el-input",{model:{value:e.form2.bind_domain,callback:function(t){e.$set(e.form2,"bind_domain",t)},expression:"form2.bind_domain"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站根目录"}},[s("el-input",{attrs:{disabled:""},model:{value:e.form2.root_path,callback:function(t){e.$set(e.form2,"root_path",t)},expression:"form2.root_path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"PHP版本"}},[s("el-select",{model:{value:e.form2.site_info.php_ver,callback:function(t){e.$set(e.form2.site_info,"php_ver",t)},expression:"form2.site_info.php_ver"}},[s("el-option",{attrs:{label:"php5.6",value:"php5.6"}}),e._v(" "),s("el-option",{attrs:{label:"php7.0",value:"php7.0"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开启SSL"}},[s("el-switch",{model:{value:e.form2.site_info.is_ssl,callback:function(t){e.$set(e.form2.site_info,"is_ssl",t)},expression:"form2.site_info.is_ssl"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form2.site_info.is_ssl,expression:"form2.site_info.is_ssl"}],attrs:{label:"crt的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----"},model:{value:e.form2.site_info.sslcrt,callback:function(t){e.$set(e.form2.site_info,"sslcrt",t)},expression:"form2.site_info.sslcrt"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form2.site_info.is_ssl,expression:"form2.site_info.is_ssl"}],attrs:{label:"key的内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"-----BEGIN RSA PRIVATE KEY----- ... -----END RSA PRIVATE KEY-----"},model:{value:e.form2.site_info.sslkey,callback:function(t){e.$set(e.form2.site_info,"sslkey",t)},expression:"form2.site_info.sslkey"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启301"}},[s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.set_301,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"set_301",t)},expression:"form2.site_info.extra_kwargs.set_301"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form2.site_info.extra_kwargs.set_301,expression:"form2.site_info.extra_kwargs.set_301"}],attrs:{label:"跳转的域名"}},[s("el-input",{model:{value:e.form2.site_info.domain_301,callback:function(t){e.$set(e.form2.site_info,"domain_301",t)},expression:"form2.site_info.domain_301"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启日志"}},[s("el-switch",{model:{value:e.form2.site_info.is_log,callback:function(t){e.$set(e.form2.site_info,"is_log",t)},expression:"form2.site_info.is_log"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"额外设置"}},[e._v("\n      开启404错误页\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.set_404,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"set_404",t)},expression:"form2.site_info.extra_kwargs.set_404"}}),e._v("屏蔽非常见UA\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.deny_ua,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"deny_ua",t)},expression:"form2.site_info.extra_kwargs.deny_ua"}}),e._v("启用防盗链\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.deny_referer,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"deny_referer",t)},expression:"form2.site_info.extra_kwargs.deny_referer"}}),e._v("安全加固\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.safe,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"safe",t)},expression:"form2.site_info.extra_kwargs.safe"}}),e._v("开启缓存\n      "),s("el-switch",{model:{value:e.form2.site_info.extra_kwargs.cache,callback:function(t){e.$set(e.form2.site_info.extra_kwargs,"cache",t)},expression:"form2.site_info.extra_kwargs.cache"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网站备注"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form2.note,callback:function(t){e.$set(e.form2,"note",t)},expression:"form2.note"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onUpsite}},[e._v("更新站点")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var h=s("C7Lr")(d,_,!1,function(e){s("X2xT")},"data-v-275818b3",null).exports,g={name:"Ftp",data:function(){return{ftplistData:[],pages:1,num:5,page:1,total:1,nid:"",search:"",is_ftplist:!0,is_create:!0,is_update:!1,form:{ftp_user:"",ftp_path:""},form2:{}}},methods:{handleCurrentChange:function(e){this.page=e,this.ongetFtp()},ongetFtp:function(){var e=this,t={nid:this.nid,page:this.page};this.$http.getftp(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.ftplistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_ftplist=!1))}).catch(function(e){console.log(e)})},onAddFtp:function(){var e=this;if(""!=this.form.ftp_path)var t="/home/wwwroot/"+this.form.ftp_path;else t="";var s={ftp_user:this.form.ftp_user,ftp_passwd:this.form.ftp_passwd,ftp_path:t};this.$http.addftp(s).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"创建站点成功",type:"success"}),e.ongetFtp()}}).catch(function(t){t.response?e.$message.error(t.response.data.errmsg):console.log(t.message),console.log(t.config)})},handleEdit:function(e){this.nid=e,this.ongetFtp()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delftp(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){e.data;t.ongetFtp()}}).catch(function(e){e.response?t.errmsg=e.response.data.errmsg:console.log(e.message),console.log(e.config)})},onupFtp:function(){var e=this,t={nid:this.nid,ftp_user:this.form2.ftp_user,ftp_passwd:this.form2.ftp_passwd,ftp_path:this.form2.ftp_path,status:this.form2.status};this.$http.upftp(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"更新站点成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_ftplist=!0,e.nid="",e.ongetFtp()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_ftplist=!0,this.ongetFtp()}},created:function(){this.ongetFtp()}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ftp"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_ftplist,expression:"is_ftplist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.ftplistData}},[s("el-table-column",{attrs:{label:"FTP用户名",prop:"ftp_user"}}),e._v(" "),s("el-table-column",{attrs:{label:"FTP密码",prop:"ftp_passwd"}}),e._v(" "),s("el-table-column",{attrs:{label:"路径",prop:"ftp_path"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_ftplist,expression:"is_ftplist"}],staticStyle:{"margin-top":"20px","text-align":"center"}},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.num,"page-count":e.pages},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"FTP名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.ftp_user,callback:function(t){e.$set(e.form,"ftp_user",t)},expression:"form.ftp_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.ftp_passwd,callback:function(t){e.$set(e.form,"ftp_passwd",t)},expression:"form.ftp_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP根目录"}},[s("el-input",{attrs:{placeholder:"默认是/home/wwwroot/FTP用户名"},model:{value:e.form.ftp_path,callback:function(t){e.$set(e.form,"ftp_path",t)},expression:"form.ftp_path"}},[s("template",{slot:"prepend"},[e._v("/home/wwwroot/")])],2)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddFtp}},[e._v("创建站点")]),e._v(" "),s("el-button",[e._v("取消")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"FTP名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.ftp_user,callback:function(t){e.$set(e.form2,"ftp_user",t)},expression:"form2.ftp_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form2.ftp_passwd,callback:function(t){e.$set(e.form2,"ftp_passwd",t)},expression:"form2.ftp_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"FTP根目录"}},[s("el-input",{attrs:{placeholder:"",disabled:""},model:{value:e.form2.ftp_path,callback:function(t){e.$set(e.form2,"ftp_path",t)},expression:"form2.ftp_path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"开启/关闭"}},[s("el-switch",{model:{value:e.form2.status,callback:function(t){e.$set(e.form2,"status",t)},expression:"form2.status"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onupFtp}},[e._v("更新站点")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var w=s("C7Lr")(g,v,!1,function(e){s("ikLQ")},"data-v-37bf4875",null).exports,b=s("a3Yh"),y=s.n(b),k={name:"Mysql",data:function(){return y()({mysqllistData:[],pages:1,num:5,page:1,total:1,nid:"",search:"",form:{mysql_user:""},form2:{},is_mysqllist:!0,is_create:!0,is_update:!1},"nid","")},methods:{handleCurrentChange:function(e){this.page=e,this.ongetMysql()},ongetMysql:function(){var e=this,t={nid:this.nid,page:this.page};this.$http.getmysql(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.mysqllistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages,""!=e.nid&&(e.form2=t.data[0],e.is_create=!1,e.is_update=!0,e.is_mysqllist=!1))}).catch(function(e){console.log(e)})},onAddMysql:function(){var e=this,t={mysql_user:this.form.mysql_user,mysql_name:this.form.mysql_name,mysql_passwd:this.form.mysql_passwd,accept:this.form.accept};this.$http.addmysql(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"创建数据库成功",type:"success"}),e.ongetMysql()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},handleEdit:function(e){this.nid=e,this.ongetMysql()},handleDelete:function(e){var t=this,s={nid:e};this.$http.delmysql(s).then(function(e){if(t.errmsg=e.errmsg,0===e.errcode){e.data;t.ongetMysql()}}).catch(function(e){e.response?t.errmsg=e.response.data.errmsg:console.log(e.message),console.log(e.config)})},onupMysql:function(){var e=this,t={nid:this.nid,mysql_passwd:this.form2.mysql_passwd,accept:this.form2.accept};this.$http.upmysql(t).then(function(t){if(e.errmsg=t.errmsg,0===t.errcode){t.data;e.$message({message:"更新数据库成功",type:"success"}),e.is_create=!0,e.is_update=!1,e.is_mysqllist=!0,e.nid="",e.ongetMysql()}}).catch(function(t){t.response?(e.errmsg=t.response.data.errmsg,e.$message.error(e.errmsg)):console.log(t.message),console.log(t.config)})},goback:function(e){"update"==e&&(this.nid=""),this.is_update=!1,this.is_create=!0,this.is_mysqllist=!0,this.ongetMysql(this.nid)}},created:function(){this.ongetMysql(this.nid)}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ftp"},[s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.is_mysqllist,expression:"is_mysqllist"}],staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.mysqllistData}},[s("el-table-column",{attrs:{label:"Mysql用户名",prop:"mysql_user"}}),e._v(" "),s("el-table-column",{attrs:{label:"Mysql数据库",prop:"mysql_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"Mysql密码",prop:"mysql_passwd"}}),e._v(" "),s("el-table-column",{attrs:{label:"连接地址",prop:"accept"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.nid)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.nid)}}})]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_mysqllist,expression:"is_mysqllist"}],staticStyle:{"margin-top":"20px","text-align":"center"}},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.num,"page-count":e.pages},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_create,expression:"is_create"}],ref:"form",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"Mysql用户名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysql_user,callback:function(t){e.$set(e.form,"mysql_user",t)},expression:"form.mysql_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql数据库 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成"},model:{value:e.form.mysql_name,callback:function(t){e.$set(e.form,"mysql_name",t)},expression:"form.mysql_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.mysql_passwd,callback:function(t){e.$set(e.form,"mysql_passwd",t)},expression:"form.mysql_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"连接方式 "}},[s("el-input",{attrs:{placeholder:"%/localhost/ip地址"},model:{value:e.form.accept,callback:function(t){e.$set(e.form,"accept",t)},expression:"form.accept"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onAddMysql}},[e._v("创建数据库")]),e._v(" "),s("el-button",[e._v("返回")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.is_update,expression:"is_update"}],ref:"form2",staticStyle:{width:"90%","margin-top":"20px"},attrs:{model:e.form2,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"Mysql用户名 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.mysql_user,callback:function(t){e.$set(e.form2,"mysql_user",t)},expression:"form2.mysql_user"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql数据库 "}},[s("el-input",{attrs:{placeholder:"3-10个字母组成",disabled:""},model:{value:e.form2.mysql_name,callback:function(t){e.$set(e.form2,"mysql_name",t)},expression:"form2.mysql_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Mysql密码 "}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form2.mysql_passwd,callback:function(t){e.$set(e.form2,"mysql_passwd",t)},expression:"form2.mysql_passwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"连接方式 "}},[s("el-input",{attrs:{placeholder:"%/localhost/ip地址"},model:{value:e.form2.accept,callback:function(t){e.$set(e.form2,"accept",t)},expression:"form2.accept"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onupMysql}},[e._v("更新数据库")]),e._v(" "),s("el-button",{on:{click:function(t){return e.goback("update")}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var q=s("C7Lr")(k,x,!1,function(e){s("RnOF")},"data-v-3e07afa3",null).exports,$={name:"Soft",data:function(){return{pages:1,num:5,page:1,total:1,nid:"",sotlistData:[],search:"",dialogFormVisible:!1,installform:{nid:"",soft_name:"",installtype:""},formLabelWidth:"120px"}},methods:{send:function(){console.log(1111111111),this.$socket.emit("message","1111111111")},handleCurrentChange:function(e){this.page=e,this.onGetsoft()},onGetsoft:function(){var e=this,t={nid:this.nid,page:this.page};this.$http.getsoft(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.sotlistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages)}).catch(function(e){})},handleInstall:function(e,t,s){this.dialogFormVisible=!0,this.installform.nid=e,this.installform.soft_name=t,this.installform.soft_ver=s,this.installform.installtype="rpm"},handleUninstall:function(){console.log("卸载成功")},InstallSoft:function(){var e=this;this.dialogFormVisible=!1,this.$http.upsoft(this.installform).then(function(t){if(0===t.errcode){t.data;e.$message({message:t.errmsg,type:"success"}),e.onGetsoft()}}).catch(function(e){})},onSearch:function(){var e=this;if(""!=this.search){var t={soft_name:this.search};this.$http.getsoft(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.sotlistData=t.data,e.total=t.total,e.page=t.page,e.pages=t.pages)}).catch(function(e){})}}},sockets:{connect:function(){console.log("socket connected")},message:function(e){console.log("返回:"+e)}},created:function(){this.onGetsoft()}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{staticStyle:{width:"90%","margin-top":"20px"},attrs:{data:e.sotlistData}},[s("el-table-column",{attrs:{label:"软件名称",prop:"soft_name"}}),e._v(" "),s("el-table-column",{attrs:{label:"软件版本",prop:"soft_ver"}}),e._v(" "),s("el-table-column",{attrs:{label:"软件描述",prop:"soft_desc"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入软件名称搜索"},nativeOn:{keyup:function(t){return e.onSearch(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.is_install?2==t.row.is_install?s("el-button",{attrs:{size:"mini",icon:"el-icon-loading"}},[e._v("安装中")]):s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-remove"},on:{click:function(s){return e.handleUninstall(t.row.nid)}}},[e._v("卸载")]):s("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus"},on:{click:function(s){return e.handleInstall(t.row.nid,t.row.soft_name,t.row.soft_ver)}}},[e._v("安装")])]}}])})],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px","text-align":"center"}},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.num,"page-count":e.pages},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:"安装方式",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.installform}},[s("el-form-item",{attrs:{label:"软件名称","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.installform.soft_name,callback:function(t){e.$set(e.installform,"soft_name",t)},expression:"installform.soft_name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"软件版本","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.installform.soft_ver,callback:function(t){e.$set(e.installform,"soft_ver",t)},expression:"installform.soft_ver"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"安装方式","label-width":e.formLabelWidth}},[s("el-radio",{attrs:{label:"rpm"},model:{value:e.installform.installtype,callback:function(t){e.$set(e.installform,"installtype",t)},expression:"installform.installtype"}},[e._v("极速")]),e._v(" "),s("el-radio",{attrs:{label:"bash"},model:{value:e.installform.installtype,callback:function(t){e.$set(e.installform,"installtype",t)},expression:"installform.installtype"}},[e._v("编译")])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.InstallSoft}},[e._v("安 装")])],1)],1)],1)},staticRenderFns:[]};var S=s("C7Lr")($,F,!1,function(e){s("Nq33")},null,null).exports,C={name:"Login",data:function(){return{username:"",password:""}},methods:{onLogin:function(){var e=this,t={username:this.username,password:this.password};this.$http.login(t).then(function(t){if(0===t.errcode){var s=t.data.username,o=t.data.token;t.data.www_path;localStorage.setItem("username",s),localStorage.setItem("token",o);var a={token:localStorage.getItem("token"),username:localStorage.getItem("username")};e.$store.dispatch("getUserInfo",a),e.$message({message:"登录成功",type:"success"}),e.$router.go(-1)}else e.$message.error(t.errmsg)}).catch(function(e){console.log(e)})}},components:{}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("div",{staticStyle:{width:"60%","margin-top":"20px","text-align":"center"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("el-input",{staticStyle:{"margin-top":"20px"},attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onLogin(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.onLogin}},[e._v("登 录")])],1)])},staticRenderFns:[]};var E=s("C7Lr")(C,I,!1,function(e){s("r3yy")},null,null).exports,L={name:"File",data:function(){return{basedir:"",filelistData:[],search:"",newdir:"",page:"",dialogFormVisible:!1,dialogFormVisible2:!1,fileform:{content:""},fileform2:{},formLabelWidth:"120px"}},methods:{newDir:function(){localStorage.setItem("olddir",this.newdir),this.newdir=localStorage.getItem("newdir2"),this.ongetFile()},backDir:function(){localStorage.setItem("newdir2",this.newdir),this.newdir=localStorage.getItem("olddir"),this.ongetFile()},newFile:function(){this.dialogFormVisible2=!0,this.fileform2.basedir=this.basedir},SaveFile2:function(){var e=this;this.dialogFormVisible2=!1;var t=new FormData,s=this.fileform2.basedir+"/"+this.fileform2.name;t.append("file",s),t.append("content",this.fileform2.content),this.$http.upfile(t).then(function(t){0===t.errcode&&(e.$message({message:"新建文件成功",type:"success"}),e.ongetFile())})},SaveFile:function(){var e=this;this.dialogFormVisible=!1;var t=new FormData;t.append("file",this.fileform.filename),t.append("content",this.fileform.content),this.$http.upfile(t).then(function(t){0===t.errcode&&(e.$message({message:"文件修改成功",type:"success"}),e.ongetFile())})},handleEdit:function(e,t){var s=this;if("file"===t){this.dialogFormVisible=!0;var o=this.basedir+"/"+e;this.fileform.filename=o;var a={file:o};this.$http.getfile(a).then(function(e){s.errmsg=e.errmsg,0===e.errcode&&(s.fileform.content=e.data)}).catch(function(e){console.log(e)})}},handleDelete:function(e,t){var s=this,o={file:this.basedir+"/"+e,type:t};this.$http.delfile(o).then(function(e){s.errmsg=e.errmsg,0===e.errcode&&(s.$message({message:"文件删除成功",type:"success"}),s.ongetFile())}).catch(function(e){})},gogetFile:function(e,t){"dir"===t?(localStorage.setItem("olddir",this.newdir),this.newdir=this.basedir+"/"+e,this.ongetFile()):this.handleEdit(e,t)},handleCurrentChange:function(e){this.page=e,this.ongetFtp()},ongetFile:function(){var e=this,t={d:this.newdir,page:this.page};this.$http.getfile(t).then(function(t){e.errmsg=t.errmsg,0===t.errcode&&(e.basedir=t.basedir,e.filelistData=t.data)}).catch(function(e){console.log(e)})}},created:function(){this.newdir=this.$route.params.d,this.ongetFile()}},D={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"site"},[s("el-table",{staticStyle:{width:"90%",margin:"20px"},attrs:{data:e.filelistData}},[s("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return["dir"===t.row.type?s("i",{staticClass:"el-icon-folder"}):s("i",{staticClass:"el-icon-files"}),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"},on:{click:function(s){return e.gogetFile(t.row.name,t.row.type)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",prop:"ctime"}}),e._v(" "),s("el-table-column",{attrs:{label:"修改时间",prop:"utime"}}),e._v(" "),s("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row.name,t.row.type)}}}),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.row.name,t.row.type)}}})]}}])},[s("template",{slot:"header"},[s("el-button",{attrs:{size:"mini",icon:"el-icon-back"},on:{click:function(t){return e.backDir()}}}),e._v(" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-right"},on:{click:function(t){return e.newDir()}}}),e._v(" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.newFile()}}})],1)],2)],1),e._v(" "),s("el-dialog",{attrs:{title:"编辑文件",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.fileform}},[s("el-form-item",{attrs:{label:"文件内容","label-width":e.formLabelWidth}},[s("el-input",{attrs:{type:"textarea",rows:15},model:{value:e.fileform.content,callback:function(t){e.$set(e.fileform,"content",t)},expression:"fileform.content"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("返 回")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.SaveFile}},[e._v("保 存")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"新建文件",visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[s("el-form",{attrs:{model:e.fileform2}},[s("el-form-item",{attrs:{label:"文件名称","label-width":e.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.fileform2.name,callback:function(t){e.$set(e.fileform2,"name",t)},expression:"fileform2.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"文件内容","label-width":e.formLabelWidth}},[s("el-input",{attrs:{type:"textarea",rows:15},model:{value:e.fileform2.content,callback:function(t){e.$set(e.fileform2,"content",t)},expression:"fileform2.content"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("返 回")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.SaveFile2}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var M=s("C7Lr")(L,D,!1,function(e){s("WPcW")},null,null).exports;a.default.use(c.a);var N=new c.a({mode:"history",routes:[{path:"/",name:"Home",component:p,meta:{requiresAuth:!0}},{path:"/site",name:"Site",component:h,meta:{requiresAuth:!0}},{path:"/ftp",name:"Ftp",component:w,meta:{requiresAuth:!0}},{path:"/mysql",name:"Mysql",component:q,meta:{requiresAuth:!0}},{path:"/soft",name:"Soft",component:S,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:E},{path:"/file",name:"File",component:M}]}),T=(s("KwFe"),s("2bvH"));a.default.use(T.a);var A=new T.a.Store({state:{userInfo:{}},mutations:{getUserInfo:function(e,t){e.userInfo=t},accountLogout:function(e){e.userInfo={}}},actions:{getUserInfo:function(e,t){(0,e.commit)("getUserInfo",t)},accountLogout:function(e){(0,e.commit)("accountLogout")}}}),V=s("84iU"),P=s.n(V),z=s("KPSb"),R=s.n(z);P.a.defaults.baseURL="http://"+window.location.host+"/api/v1",P.a.defaults.timeout=3e3;var G="/login",U="/site",W="/ftp",H="/mysql",K="/home",Y="/soft",B="/ssl",O="/user",Q="/file";function Z(e){return P.a.post(G,e).then(function(e){return e.data})}function X(e){return P.a.post(G,e).then(function(e){return e.data})}function j(e){return P.a.get(U,{params:e}).then(function(e){return e.data})}function J(e){return P.a.delete(U,{data:e}).then(function(e){return e.data})}function ee(e){return P.a.post(U,e).then(function(e){return e.data})}function te(e){return P.a.put(U,e).then(function(e){return e.data})}function se(e){return P.a.get(W,{params:e}).then(function(e){return e.data})}function oe(e){return P.a.post(W,e).then(function(e){return e.data})}function ae(e){return P.a.delete(W,{data:e}).then(function(e){return e.data})}function ne(e){return P.a.put(W,e).then(function(e){return e.data})}function ie(e){return P.a.get(H,{params:e}).then(function(e){return e.data})}function re(e){return P.a.post(H,e).then(function(e){return e.data})}function le(e){return P.a.delete(H,{data:e}).then(function(e){return e.data})}function fe(e){return P.a.put(H,e).then(function(e){return e.data})}function ce(e){return P.a.get(K+"?info="+e).then(function(e){return e.data})}function me(e){return P.a.get(Y,{params:e}).then(function(e){return e.data})}function ue(e){return P.a.put(Y,e).then(function(e){return e.data})}function pe(e){return P.a.post(B,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){return e.data})}function de(e){return P.a.post(O,e).then(function(e){return e.data})}function _e(e){return P.a.get(Q,{params:e}).then(function(e){return e.data})}function he(e){return P.a.delete(Q,{data:e}).then(function(e){return e.data})}function ge(e){return P.a.put(Q,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){return e.data})}P.a.interceptors.request.use(function(e){var t=localStorage.getItem("username"),s=localStorage.getItem("token");if(t&&s){var o=Math.round((new Date).getTime()/1e3);e.headers.otime=o,e.headers.username=t,e.headers.accesstoken=R()(t+o.toString()+s)}return e},function(e){n.Message.error({message:"请求超时!"})}),P.a.interceptors.response.use(function(e){return 4023!=e.data.errcode&&4024!=e.data.errcode&&4026!=e.data.errcode||n.MessageBox.alert("你已被登出,请重新登录","重新登录",{confirmButtonText:"确定",callback:function(e){A.dispatch("accountLogout").then(function(){localStorage.clear(),location.reload()})}}),e},function(e){400==e.response.status||422==e.response.status?n.Message.error({message:e.response.data.errmsg}):n.Message.error({message:"未知错误!"})}),a.default.prototype.$http=o,a.default.prototype.$md5=R.a,a.default.config.productionTip=!1,a.default.use(i.a),N.beforeEach(function(e,t,s){if(e.meta.requiresAuth)if(localStorage.getItem("token")){var o={token:localStorage.getItem("token"),username:localStorage.getItem("username")};A.dispatch("getUserInfo",o),s()}else s({name:"Login"});else s()}),new a.default({el:"#app",router:N,store:A,components:{App:f},template:"<App/>"})},Nq33:function(e,t){},RnOF:function(e,t){},WPcW:function(e,t){},X2xT:function(e,t){},ikLQ:function(e,t){},r3yy:function(e,t){},rHZV:function(e,t){},u8Cu:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8deeaa1554daf4d6e7b5.js.map